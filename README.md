Shameless "refactoring" of Pimoroni code for my own tinkering
