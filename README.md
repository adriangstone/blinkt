Shameless "refactering" of Pimoroni code for my own tinkering
